{% extends "base.html" %}

{% block content %}

<h1 class="cute-title rainbow-text" style="text-align:center; margin-top:40px;">
  ğŸŒ¸ğŸ‘ Welcome to Yorkie Bakery ğŸ“ğŸ€
</h1>

<p class="cute-subtitle" style="text-align:center; margin-bottom:32px;">
  Baked fresh every day â€” let our Yorkie Chef ğŸ¶âœ¨ help you pick the perfect treat ğŸ¾ğŸ°
</p>

<section class="home-section">
  <h2 class="cute-title" style="text-align:center;"> ğŸ¾ Menu Recommendation ğŸ‘¨â€ğŸ³</h2>
  <div style="text-align:center; margin-bottom:24px;">
    <button id="ai-demo-btn" class="btn-outline"
            style="padding: 20px 40px; font-size: 20px;">
       ğŸ¤– AI Menu & Image Match
    </button>
  </div>

  <!-- ğŸ° Featured Menu Section -->
  <h2 class="cute-title" style="text-align:center;">ğŸ° Featured Menu ğŸ˜</h2>
  <div style="text-align:center; margin-bottom:24px;">
    <a href="/menu/view" class="btn-outline">ğŸ½ï¸ Browse Our Menu ğŸŒ¸</a>
  </div>
  <div class="menu-carousel">
    <button class="carousel-btn" id="menu-prev" aria-label="Previous pastries">â€¹</button>
    <div class="menu-window" id="menu-window">
      <div class="menu-track" id="menu-track">
        {% for item in menu_items %}
        <div class="menu-card menu-card-compact">
          <img src="{{ item.image_url or '/static/default_menu_image.jpg' }}" alt="{{ item.title }}">
          {% set stats = review_stats.get(item.id|string) if review_stats else None %}
          <div style="display:flex; align-items:center; justify-content:space-between; gap:8px;">
            <h3 style="margin:0;">{{ item.title }}</h3>
            {% if stats and stats.avg %}
              <span class="menu-rating" style="white-space:nowrap; font-weight:600;">â­ {{ "%.1f"|format(stats.avg) }}</span>
            {% endif %}
          </div>
          {% if stats and stats.avg and stats.count %}
            <div style="display:flex; gap:6px; flex-wrap:wrap; margin-top:6px;">
              {% if stats.avg >= 4.8 and stats.count >= 5 %}
                <span style="display:inline-flex; align-items:center; gap:6px; font-size:13px; font-weight:700; color:#d35400; background:#ffe9d6; padding:4px 8px; border-radius:999px;">
                  ğŸ”¥ Most Popular
                </span>
              {% elif stats.count >= 3 %}
                <span style="display:inline-flex; align-items:center; gap:6px; font-size:13px; font-weight:700; color:#8a5a00; background:#fff3d9; padding:4px 8px; border-radius:999px;">
                  âœ¨ Trending Now
                </span>
              {% endif %}
              {% if item.tags and ('chef special' in item.tags) %}
                <span style="display:inline-flex; align-items:center; gap:6px; font-size:13px; font-weight:700; color:#9c27b0; background:#f5e9ff; padding:4px 8px; border-radius:999px;">
                  ğŸ‘¨â€ğŸ³ Chef Special
                </span>
              {% endif %}
            </div>
          {% endif %}
          <p>{{ item.description or '' }}</p>
          {% if item.price is not none %}
            <p class="price">
              <span class="old-price">${{ "%.2f"|format(item.price) }}</span>
              <span class="free-pill">Free</span>
            </p>
          {% endif %}
        </div>
        {% endfor %}
      </div>
    </div>
    <button class="carousel-btn" id="menu-next" aria-label="Next pastries">â€º</button>
  </div>
</section>

<!-- ğŸµ Music Section -->
<section class="home-section home-section-alt">
  <h2 class="cute-title" style="text-align:center;">ğŸ¼ Classical Music</h2>
  <div style="text-align:center; margin-bottom:24px;">
    <a href="/music/listen" class="btn-outline">ğŸµ Browse Oscar's Music ğŸ¹ğŸ»</a>
  </div>

  <div class="music-carousel">
    <button class="carousel-btn" id="music-prev" aria-label="Previous tracks">â€¹</button>
    <div class="music-window" id="music-window">
      <div class="music-track" id="music-track">
        {% for track in tracks %}
        <div class="home-music-card music-track-card" data-track-id="{{ track.id }}">

          <div class="music-cover-wrap">
            {% if track.cover_url %}
              <img src="{{ track.cover_url }}"
                   alt="{{ track.title }}"
                   class="home-music-cover">
            {% else %}
              <img src="/static/images/default_music_cover.jpg"
                   alt="No cover"
                   class="home-music-cover">
            {% endif %}
            {% if track.file_url %}
              <button
                class="cover-play-btn play-track-btn"
                type="button"
                aria-label="Play {{ track.title }}"
                data-track-id="{{ track.id }}"
                data-title="{{ track.title }}"
                data-composer="{{ track.composer }}"
                data-performer="{{ track.performer }}"
                data-file="{{ track.file_url }}"
                data-cover="{{ track.cover_url if track.cover_url else '/static/images/default_music_cover.jpg' }}">
                â–¶
              </button>
            {% endif %}
          </div>
          <h3 class="home-music-title">{{ track.title }}</h3>
        </div>
        {% endfor %}
      </div>
    </div>
    <button class="carousel-btn" id="music-next" aria-label="Next tracks">â€º</button>
  </div>

  <!-- Inline music player (reuses main player logic, but anchored here) -->
  <div class="floating-player inline-player" id="floating-player">
    <div class="fp-left">
      <div class="fp-cover">
        <img id="fp-cover-img" src="/static/images/default_music_cover.jpg" alt="Cover">
      </div>
      <div class="fp-meta">
        <div id="fp-title"></div>
        <div id="fp-subtitle" class="fp-subtitle"></div>
      </div>
    </div>

    <div class="fp-center">
      <div class="fp-controls">
        <button class="fp-icon-btn icon-shuffle" id="fp-shuffle" type="button" aria-pressed="false" aria-label="Shuffle" title="Shuffle"></button>
        <button class="fp-icon-btn icon-prev" id="fp-prev" type="button" aria-label="Previous" title="Previous"></button>
        <button class="fp-icon-btn fp-play" id="fp-play" type="button" aria-label="Play/Pause" title="Play/Pause"></button>
        <button class="fp-icon-btn icon-next" id="fp-next" type="button" aria-label="Next" title="Next"></button>
        <button class="fp-icon-btn icon-repeat" id="fp-repeat" type="button" aria-pressed="false" aria-label="Repeat" title="Repeat"></button>
        <div class="fp-volume">
          <button class="fp-icon-btn icon-volume-toggle" id="fp-mute" type="button" aria-pressed="false" aria-label="Mute/Unmute" title="Mute/Unmute"></button>
          <input type="range" id="fp-volume" min="0" max="100" value="100" step="1" aria-label="Volume">
        </div>
      </div>
      <div class="fp-progress">
        <span id="fp-current-time">0:00</span>
        <input type="range" id="fp-seek" min="0" max="100" value="0" step="1" aria-label="Seek">
        <span id="fp-duration">0:00</span>
      </div>
    </div>

    <audio id="global-audio"></audio>
  </div>
</section>

<!-- ğŸ“± Mobile App Section -->
<section style="background:#2f2f2f; color:#e6e6e6; padding:80px 0;">
  <div style="max-width:1100px; margin:0 auto; display:flex; gap:32px; align-items:center; justify-content:center; flex-wrap:wrap;">
    <div style="flex:1 1 320px; display:flex; justify-content:center;">
      <img src="/static/images/iphone.png" alt="Yorkie Bakery App preview on iPhone" style="width:320px; max-width:100%; display:block;">
    </div>
    <div style="flex:0 1 200px; display:flex; justify-content:center;">
      <img src="/static/images/iwatch.png" alt="Yorkie Bakery App preview on iWatch" style="width:180px; max-width:100%; display:block;">
    </div>
    <div style="flex:1 1 360px; min-width:320px; max-width:500px; text-align:left; margin:0 auto;">
      <p style="margin:0 0 10px 0; color:#f1f1f1; letter-spacing:0.3px; font-size:26px; font-weight:800; font-family:'DM Sans','Playfair Display',sans-serif;">
        Happy to Announce
      </p>
      <h2 style="margin:0 0 10px 0; font-size:20px; font-weight:600; color:#dcdcdc; line-height:1.35; font-family:'DM Sans','Playfair Display',sans-serif;">
        Mobile App is coming up on neither OS platform ğŸ˜‚
      </h2>
      <div style="display:flex; gap:16px; flex-wrap:wrap; align-items:center; margin-top:10px;">
        <a href="#" aria-label="Google Play badge">
          <img src="/static/images/badge_google_store.jpg" alt="Google Play" style="height:60px; display:block;">
        </a>
        <a href="#" aria-label="App Store badge">
          <img src="/static/images/badge_apple_store.jpg" alt="App Store" style="height:60px; display:block;">
        </a>
      </div>
    </div>
  </div>
</section>

<!-- ğŸŒŸ Our Services -->
<section style="background:#fff; padding:50px 0; text-align:center;">
  <h2 class="cursive-font">ğŸŒŸ Our Services ğŸ˜‹</h2>
  <p>We offer joyful experiences for every guest!</p>
  <ul style="list-style:none; padding:0;">
    <li>ğŸ‘¶ Kid-Friendly: nanny care, academic support, and piano tutoring ğŸ§¸ ğŸ¼ ğŸ¹ ğŸ¶ ğŸ¥ ğŸ˜ ğŸ­</li>
    <li>ğŸ• Creative Culinary: custom-designed desserts and cakes ğŸ° ğŸ§ ğŸ¥® ğŸ® ğŸ© ğŸª</li>
    <li>ğŸšš Free Delivery for all your events</li>
  </ul>
</section>

<!-- ğŸ¾ About Me -->
<section style="background:#fffaf4; padding:60px 0; text-align:center;">
  <h2 class="cursive-font">ğŸ¾ About Me</h2>
  <img src="/static/images/img_oscar.jpg" alt="Chef Oscar" style="width:300px; border-radius:50%; margin-bottom:10px;">
  <p>
    Oscar is a full-time Yorkshire Terrier ğŸ¶ and part-time culinary mastermind ğŸ° born under the sunny skies of California. While most dogs chase mailmen, Oscar chased Michelin stars â€” eventually settling into life as the proud Owner & CEO of Yorkie Bakery.

    Standing a mighty eight pounds tall, he firmly believes height doesnâ€™t matter when your whisking skills are elite. His baking journey began the moment he realized treats donâ€™t magically refill themselves. After a spirited (and slightly chaotic) internship in a human kitchen, he mastered the arts of cakes, pastries, and looking adorable while demanding quality-control samples.

    When heâ€™s not in the kitchen, Oscar enjoys classical musicğŸ¶, piano improvisation, and barking at pigeons who clearly underestimate his artistic brilliance. He insists that every dessert at Yorkie Bakery is made with â€œa sprinkle of love and a whole lot of yum,â€ which â€” according to customers â€” is a surprisingly effective recipe.
  </p>
  <img src="/static/images/store.jpeg" alt="Bakery Store" style="width:500px; border-radius:10px; margin-top:20px;">
</section>

<!-- ğŸ•’ Store Hours -->
<section style="background:#fff3e3; padding:40px 0; text-align:center;">
  <h2 class="cursive-font">ğŸ•’ Store Hours </h2>
  <p>Mon â€“ Sun: CLOSED ğŸ˜‚ (Appointments Only)</p>
  <p>Contact us to book private tastings or baking classes!</p>
</section>

<!-- ğŸ‘‘ Admin Upload Section -->
{% if request.session.get("user") and request.session.get("user").get("is_admin") %}
  <hr style="margin: 40px auto; width: 60%;">
  <div style="text-align:center;">
    <h3>ğŸ› ï¸ Admin Shortcuts</h3>
    <a href="/menu/new" class="btn btn-admin">â• Add Menu Item</a>
    <a href="/music/new" class="btn btn-admin">ğŸµ Upload Music</a>
    <a href="/events/new" class="btn btn-admin">â• Create Event</a>
  </div>
{% endif %}

<!-- ğŸ¤ Sponsors -->
<div class="sponsor-strip">
  <div class="sponsor-strip-inner">
    <p class="sponsor-label">Proudly Sponsored By</p>
    <div class="sponsor-badges">
      <img src="/static/images/logo_juilliard.jpg" alt="Juilliard">
      <img src="/static/images/logo_bpo.jpg" alt="BPO">
      <img src="/static/images/logo_yamaha.jpg" alt="Yamaha">
      <img src="/static/images/logo_cliburn.jpg" alt="Cliburn">
      <img src="/static/images/logo_bucees.jpg" alt="Buc-ee's">
      <img src="/static/images/logo_heb.jpg" alt="H-E-B">
      <img src="/static/images/logo_in_n_out.jpg" alt="In-N-Out">
      <img src="/static/images/logo_white.jpg" alt="Yorkie Bakery">
    </div>
  </div>
</div>

{% endblock %}
